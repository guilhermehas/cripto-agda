\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{proofsTXTree}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Nat.Properties}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Utils}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Crypto}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Transactions}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{TXTree}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}out<time\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{out}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaBound{out}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{out}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaBound{time}\<%
\end{code}

%<*outtimeless>
\begin{code}%
\>[0]\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{outputs}\<%
\\
\>[0]\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{block}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outVec}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{txTree}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[2]\AgdaFunction{allJoin}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaBound{txTree}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{vecOutTimeLess}\AgdaSpace{}%
\AgdaBound{outVec}\<%
\\
%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{vecOutTimeLess}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sucTime}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{vecOutTimeLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fstEl}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{timeToNatSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[4]\AgdaFunction{vecOutTimeLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{timeToNatSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vecOutTimeLess}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pt}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{t1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sucTime}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{txfieldid}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaBound{address}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eqTimeNat}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaFunction{eqsuc}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaKeyword{where}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{eqsuc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)))}\<%
\\
%
\>[8]\AgdaFunction{eqsuc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{eqTimeNat}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sucTime}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{timeToNat}\AgdaSpace{}%
\AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{eqTimeNat}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[8]\AgdaFunction{eqTimeNat}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaFunction{totalQt}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaBound{tree}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{allInps}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaFunction{sucTime}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{¬::}}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{outVec}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{allInps}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[6]\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{input}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaFunction{allProofFG}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaFunction{allList→allSub}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{allInps}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{outVec}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{allInps}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[6]\AgdaFunction{allProofFG}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaFunction{allList→allSub}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{allInps}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{inputsTree→inputsTXtx}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaBound{pt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{allInps}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{input}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pt}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaFunction{allProofFG}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{≤timeSuc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{allInps}\<%
\end{code}
%</outtimeless>

%<*inptimeless>
\begin{code}%
\>[0]\AgdaFunction{inputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{tr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaBound{inputs}\<%
\\
\>[0]\AgdaFunction{inputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaBound{tr}\<%
\\
\>[0]\AgdaFunction{inputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{pAmountFee}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{outputsTimeLess}\AgdaSpace{}%
\AgdaBound{tr}\<%
\end{code}
%</inptimeless>

%<*inptxtimeless>
\begin{code}%
\>[0]\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{tr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\<%
\\
\>[0]\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{proofInput}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{inputsTimeLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{allList→allSub}\AgdaSpace{}%
\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{proofInput}\<%
\\
\>[0]\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{pAmountFee}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{inputsTimeLess}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{pAmountFee}\<%
\end{code}
%</inptxtimeless>

%<*allvecoutsametime>
\begin{code}%
\>[0]\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[2]\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fstEl}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{sameId}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaBound{vecOut}\<%
\end{code}
%</allvecoutsametime>

%<*alldists>
\begin{code}%
\>[0]\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vec<}\AgdaSpace{}%
\AgdaBound{vec≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{all<}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{out<time}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{vec<}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{all≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{vec≡}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{twoListDistinct}\AgdaSpace{}%
\AgdaBound{vec<}\AgdaSpace{}%
\AgdaBound{vec≡}\<%
\\
\>[0]\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSymbol{\AgdaDottedPattern{.}}\AgdaInductiveConstructor{\AgdaDottedPattern{[]}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vec≡}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{all≡}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
\>[0]\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vec≡}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p<}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{all<}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{all≡}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{distinctLess}\AgdaSpace{}%
\AgdaBound{all≡}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaBound{all<}\AgdaSpace{}%
\AgdaBound{all≡}\<%
\\
%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{sucRemove}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{suc≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[4]\AgdaFunction{sucRemove}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{¬n≡suck+n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{¬n≡suck+n}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
%
\>[4]\AgdaFunction{¬n≡suck+n}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eqs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{¬n≡suck+n}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sucRemove}\AgdaSpace{}%
\AgdaBound{eqs}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{trans}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add{-}suc{-}r}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{¬n<n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{¬n<n}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{¬n≡suck+n}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{distinctLess}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vec≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaBound{all≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{vec≡}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{isDistinct}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{vec≡}\<%
\\
%
\>[4]\AgdaFunction{distinctLess}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
%
\>[4]\AgdaFunction{distinctLess}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{all≡}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(λ\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{¬n<n}\AgdaSpace{}%
\AgdaBound{p<}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{distinctLess}\AgdaSpace{}%
\AgdaBound{all≡}\AgdaSymbol{)}\<%
\end{code}
%</alldists>

%<*distinps>
\begin{code}%
\>[0]\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outVec}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaBound{tree}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Distinct}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\<%
\\
\>[0]\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vecOut}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{SubInputs}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{txSigned}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[2]\AgdaFunction{distList→distSub}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{SubInputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{unionDistinct}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vecOut}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{outVec}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
%
\>[2]\AgdaFunction{unionDistinct}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\end{code}
%</distinps>

%<*uniqueouts>
\begin{code}%
\>[0]\AgdaFunction{uniqueOutputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Distinct}\AgdaSpace{}%
\AgdaBound{outputs}\<%
\\
\>[0]\AgdaFunction{uniqueOutputs}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{uniqueOutputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{block}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vecOut}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{tree}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{unionDistinct}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{inputsTX}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{distInputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{allDistincts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inputsTXTimeLess}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{allVecOutSameTime}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{))}\<%
\end{code}
%</uniqueouts>
