\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Transactions}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Nat.Properties}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Utils}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Crypto}\<%
\end{code}

%<*TXField>
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{TXField}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaInductiveConstructor{txfield}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{amount}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\<%
\\
%
\>[4]\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Address}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaInductiveConstructor{txfieldid}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{time}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\<%
\\
%
\>[4]\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[4]\AgdaField{amount}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\<%
\\
%
\>[4]\AgdaField{address}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Address}\<%
\end{code}
%</TXField>

\begin{code}%
\>[0]\AgdaKeyword{private}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≡txFieldWithId\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx1}\AgdaSpace{}%
\AgdaBound{tx2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Dec}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaBound{tx1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{tx2}\<%
\\
%
\>[2]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time1}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{position1}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount1}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address1}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{≡txFieldWithId}}\<%
\\
%
\>[4]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time2}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{position2}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount2}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address2}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{time1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{time2}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{¬eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{refl}%
\>[29]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{¬eq}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{position1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{position2}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{¬eq}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{¬eq}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{amount1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{amount2}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{¬eq}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{¬eq}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{address1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{address2}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{¬eq}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{¬eq}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{EqTXFieldWithId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Eq}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\<%
\\
%
\>[2]\AgdaFunction{EqTXFieldWithId}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}==\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≡txFieldWithId\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{removeId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{TXField}\<%
\\
\>[0]\AgdaFunction{removeId}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{addId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{position}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{txs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXField}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\<%
\\
\>[0]\AgdaFunction{addId}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{addId}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{txs}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{address}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaFunction{addId}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{position}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{txs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sameIdList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{txs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonEmptyList}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{sameIdList}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\<%
\\
\>[0]\AgdaFunction{sameIdList}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{txs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{sameIdList}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{txs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{incrementList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{order}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{txs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonEmptyList}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{incrementList}\AgdaSpace{}%
\AgdaBound{order}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[31]\AgdaField{TXFieldWithId.position}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{order}\<%
\\
\>[0]\AgdaFunction{incrementList}\AgdaSpace{}%
\AgdaBound{order}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{txs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[34]\AgdaField{TXFieldWithId.position}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{order}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{incrementList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{order}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{txs}\<%
\end{code}

%<*VectorOutput>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{sameId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{elStart}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{TXFieldWithId.position}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{TXFieldWithId.amount}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaBound{listOutput}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{sameId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{TXFieldWithId.time}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{elStart}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{TXFieldWithId.position}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{size}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{size}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{amount}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaField{TXFieldWithId.amount}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\end{code}
%</VectorOutput>

\begin{code}%
\>[0]\AgdaFunction{vecOutTime}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Time}\<%
\\
\>[0]\AgdaFunction{vecOutTime}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{outs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\<%
\\
\>[0]\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{outs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{outs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{nonNilVecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{nonNilVecOut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
\>[0]\AgdaFunction{nonNilVecOut}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Distinct}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vecOut}\<%
\\
\>[0]\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
\>[0]\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaSymbol{\{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vecOutDist}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{isDistSizeBelow}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{diff!}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{vecOut}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{zero≢sucSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPrimitive{lzero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{size}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{zero≢sucSize}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{removeSuc≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPrimitive{lzero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
%
\>[4]\AgdaFunction{removeSuc≡}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{removeSuc<}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPrimitive{lzero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
%
\>[4]\AgdaFunction{removeSuc<}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{diff!}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add{-}suc{-}r}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{ineqAux}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPrimitive{lzero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
%
\>[4]\AgdaFunction{ineqAux}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{diff!}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{diff}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add{-}suc{-}r}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{absurdEq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{absurdEq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
%
\>[4]\AgdaFunction{absurdEq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{absurdEq}\AgdaSpace{}%
\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{neq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{removeSuc≡}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSpace{}%
\AgdaBound{neq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add{-}suc{-}r}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{ineq≢eq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
%
\>[4]\AgdaFunction{ineq≢eq}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{diff!}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{absurdEq}\AgdaSpace{}%
\AgdaBound{eq}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{isDistSizeBelow}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaBound{lenVecOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{lessThan}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{lenVecOut}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{size}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{vOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{lenVecOut}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{isDistinct}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VectorOutput→List}\AgdaSpace{}%
\AgdaBound{vOut}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{isDistSizeBelow}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{lessThan}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{txOut}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ineq≢eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{elStart2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{removeSuc<}\AgdaSpace{}%
\AgdaBound{lessThan}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
%
\>[4]\AgdaFunction{isDistSizeBelow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{sizeVec}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{lessThan}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{vOut}\AgdaSpace{}%
\AgdaBound{txOut}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ineq≢eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{elStart2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{removeSuc<}\AgdaSpace{}%
\AgdaBound{lessThan}\AgdaSymbol{)\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
%
\>[6]\AgdaFunction{isDistSizeBelow}\AgdaSpace{}%
\AgdaBound{sizeVec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ineqAux}\AgdaSpace{}%
\AgdaBound{lessThan}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{vOut}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{addOutput}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amountOut}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{listOutput}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaBound{amountOut}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXField}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{size}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{amountOut}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaField{TXField.amount}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{addOutput}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{size}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amountOut}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{listOutput}\AgdaSpace{}%
\AgdaBound{txOut}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{listOutput}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{size}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{\})}\<%
\\
%
\>[2]\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[2]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{TXField}\AgdaSpace{}%
\AgdaBound{txOut}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXField}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Msg}\<%
\\
\>[0]\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{address}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{address}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{TXId→Msg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Msg}\<%
\\
\>[0]\AgdaFunction{TXId→Msg}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{time}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{time}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{position}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{address}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{address}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{position}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaInductiveConstructor{nat}\AgdaSpace{}%
\AgdaBound{address}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXField}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Msg}\<%
\\
\>[0]\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
\>[0]\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaFunction{TXId→Msg}\AgdaSpace{}%
\AgdaBound{input}\<%
\\
\>[0]\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{out2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{out2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{txEls→Msg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Msg}\<%
\\
\>[0]\AgdaFunction{txEls→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{())}\<%
\\
\>[0]\AgdaFunction{txEls→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{txInput→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaFunction{removeId}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{output}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaInductiveConstructor{unit}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{txEls→MsgVecOut}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{time}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outSize}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{input}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{outputs}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Msg}\<%
\\
\>[0]\AgdaFunction{txEls→MsgVecOut}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{el}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{removeId}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaFunction{TXId→Msg}\AgdaSpace{}%
\AgdaBound{input}\<%
\\
\>[0]\AgdaFunction{txEls→MsgVecOut}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cons}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{sameId}\AgdaSpace{}%
\AgdaBound{elStart}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{TX→Msg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{removeId}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+msg}}\AgdaSpace{}%
\AgdaFunction{txEls→MsgVecOut}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaBound{outputs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{txs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Amount}\<%
\\
\>[0]\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\<%
\\
\>[0]\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{::}}\AgdaSpace{}%
\AgdaBound{txs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaBound{txs}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaField{amount}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{TXFieldWithId}\<%
\end{code}

%<*TXSigned>
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{TXSigned}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{time}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outSize}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outAmount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{inputs}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{outputs}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{outAmount}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaInductiveConstructor{txsig}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{nonEmpty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{inputs}\<%
\\
%
\>[4]\AgdaField{signed}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[6]\AgdaRecord{SignedWithSigPbk}%
\>[985I]\AgdaSymbol{(}\AgdaFunction{txEls→MsgVecOut}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\<%
\\
\>[.]\<[985I]%
\>[23]\AgdaSymbol{(}\AgdaField{TXFieldWithId.address}\AgdaSpace{}%
\AgdaBound{input}\AgdaSymbol{))}\<%
\\
%
\>[23]\AgdaBound{inputs}\<%
\\
%
\>[4]\AgdaField{in≥out}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≥}}\AgdaSpace{}%
\AgdaBound{outAmount}\<%
\end{code}
%</TXSigned>

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{TXSignedRawOutput}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{nonEmpty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{NonNil}\AgdaSpace{}%
\AgdaBound{outputs}\<%
\\
%
\>[4]\AgdaField{signed}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{All}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[6]\AgdaRecord{SignedWithSigPbk}%
\>[1013I]\AgdaSymbol{(}\AgdaFunction{txEls→Msg}\AgdaSpace{}%
\AgdaBound{input}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaField{nonEmpty}\AgdaSymbol{)}\<%
\\
\>[.]\<[1013I]%
\>[23]\AgdaSymbol{(}\AgdaField{TXFieldWithId.address}\AgdaSpace{}%
\AgdaBound{input}\AgdaSymbol{))}\<%
\\
%
\>[23]\AgdaBound{inputs}\<%
\\
%
\>[4]\AgdaField{in≥out}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≥}}\AgdaSpace{}%
\AgdaFunction{txFieldList→TotalAmount}\AgdaSpace{}%
\AgdaBound{outputs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{txSigInput}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TXSignedRawOutput}\AgdaSpace{}%
\AgdaBound{inputs}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\<%
\\
\>[0]\AgdaFunction{txSigInput}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{inputs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{inputs}\<%
\end{code}
