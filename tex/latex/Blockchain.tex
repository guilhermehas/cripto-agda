\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Blockchain}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Utils}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Cripto}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Transactions}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{TXTree}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{nextTXTree}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₁}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaBound{qtTransactions₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaSymbol{\{}\AgdaBound{block₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{block₂}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{firstTX}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{txTree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{nextTXTree}\AgdaSpace{}%
\AgdaBound{txTree}\AgdaSpace{}%
\AgdaBound{txTree}\<%
\\
%
\>[2]\AgdaInductiveConstructor{nextTX}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{\{}\AgdaBound{block₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{time₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{qtTransactions₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₁}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaBound{qtTransactions₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{\{}\AgdaBound{block₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{block₂}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{(}\AgdaBound{nxTree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{nextTXTree}\AgdaSpace{}%
\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{outputTX}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{block₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaBound{outputTX}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{proofLessQtTX}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaDatatype{Either}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaDatatype{IsTrue}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lessNat}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{finToNat}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{totalQtSub1}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaFunction{isCoinbase}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{nextTXTree}\AgdaSpace{}%
\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{proofLessQtTX}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaDottedPattern{.}}\AgdaInductiveConstructor{\AgdaDottedPattern{genesisTree}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{coinbaseTree}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time}\AgdaSpace{}%
\AgdaBound{block}\AgdaSpace{}%
\AgdaBound{outputs}\AgdaSpace{}%
\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaBound{qtTransactions}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{coinbaseTree}\AgdaSpace{}%
\AgdaInductiveConstructor{genesisTree}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{coinbaseTree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{normalTX}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[0]\AgdaFunction{coinbaseTree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{coinbase}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\end{code}

%<*block>
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Block}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₁}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaBound{qtTransactions₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaInductiveConstructor{block}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{nxTree}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{nextTXTree}\AgdaSpace{}%
\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaBound{txTree₂}\<%
\\
%
\>[4]\AgdaField{fstBlock}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{firstTreesInBlock}\AgdaSpace{}%
\AgdaBound{txTree₁}\<%
\\
%
\>[4]\AgdaField{sndBlockCoinbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{coinbaseTree}\AgdaSpace{}%
\AgdaBound{txTree₂}\<%
\end{code}
%</block>

%<*blockchain>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Blockchain}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaBound{block₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₁}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaBound{qtTransactions₁}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\{}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Block}\AgdaSpace{}%
\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{→}%
\>[381I]\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[.]\<[381I]%
\>[4]\AgdaInductiveConstructor{fstBlock}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{\{}\AgdaBound{block₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{time₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₁}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₁}\AgdaSpace{}%
\AgdaBound{totalFees₁}\AgdaSpace{}%
\AgdaBound{qtTransactions₁}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaBound{block₁}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Block}\AgdaSpace{}%
\AgdaBound{txTree₁}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Blockchain}\AgdaSpace{}%
\AgdaBound{block}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaInductiveConstructor{addBlock}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{\{}\AgdaBound{block{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{time{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{txTree{-}p₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time{-}p₁}\AgdaSpace{}%
\AgdaBound{block{-}p₁}\AgdaSpace{}%
\AgdaBound{outputs{-}p₁}\AgdaSpace{}%
\AgdaBound{totalFees{-}p₁}\AgdaSpace{}%
\AgdaBound{qtTransactions{-}p₁}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaSymbol{\{}\AgdaBound{time{-}p₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs{-}p₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees{-}p₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions{-}p₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{txTree{-}p₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time{-}p₂}\AgdaSpace{}%
\AgdaBound{block{-}p₁}\AgdaSpace{}%
\AgdaBound{outputs{-}p₂}\AgdaSpace{}%
\AgdaBound{totalFees{-}p₂}\AgdaSpace{}%
\AgdaBound{qtTransactions{-}p₂}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{block{-}p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Block}\AgdaSpace{}%
\AgdaBound{txTree{-}p₁}\AgdaSpace{}%
\AgdaBound{txTree{-}p₂}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaBound{blockchain}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Blockchain}\AgdaSpace{}%
\AgdaBound{block{-}p}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{amount}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputTX}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VectorOutput}\AgdaSpace{}%
\AgdaBound{time{-}p₂}\AgdaSpace{}%
\AgdaBound{outSize}\AgdaSpace{}%
\AgdaBound{amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{qtTransactions}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TX}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{time{-}p₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{block{-}p₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outputs{-}p₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{outSize}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{txTree{-}p₂}\AgdaSpace{}%
\AgdaBound{outputTX}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{proofLessQtTX}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaDatatype{Either}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaDatatype{IsTrue}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lessNat}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{finToNat}\AgdaSpace{}%
\AgdaBound{qtTransactions{-}p₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{totalQtSub1}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{isCoinbase}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaSymbol{\{}\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Time}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{TXFieldWithId}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Amount}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{qtTransactions₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{tQtTxs}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{\{}\AgdaBound{txTree₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{TXTree}\AgdaSpace{}%
\AgdaBound{time₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nextBlock}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{outputs₂}\AgdaSpace{}%
\AgdaBound{totalFees₂}\AgdaSpace{}%
\AgdaBound{qtTransactions₂}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaSymbol{(}\AgdaBound{block}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Block}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{txtree}\AgdaSpace{}%
\AgdaBound{txTree{-}p₂}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{proofLessQtTX}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{txTree₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Blockchain}\AgdaSpace{}%
\AgdaBound{block}\<%
\end{code}
%</blockchain>
